<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>coreSNTP: Sntp_ReceiveTimeResponse</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">coreSNTP<span id="projectnumber">&#160;v1.1.0</span>
   </div>
   <div id="projectbrief">Client library for synchronizing device time with internet time using Simple Network Time Protocol (SNTP)</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('sntp_receivetimeresponse_function.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Sntp_ReceiveTimeResponse </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >Receives a time response from the server that has been requested for time with the <a class="el" href="core__sntp__client_8h.html#ae6cb1fe85cff973b2cfa73751adb4062">Sntp_SendTimeRequest</a> API function. Once an accepted response containing time from server is received, this function calls the user-defined <a class="el" href="group__sntp__callback__types.html#gade7b1a15684e1272ef7dbb9e4486c285">SntpSetTime_t</a> function to update the system time.</p>
<dl class="section note"><dt>Note</dt><dd>If the user has provided an authentication interface to the client (through <a class="el" href="core__sntp__client_8h.html#ae7f3fa647cd74f09878af88e430707fc">Sntp_Init</a>), the server response is authenticated by calling the <a class="el" href="group__sntp__callback__types.html#gae382a67b0ffbb4721d8d599efe3020c4">SntpValidateServerAuth_t</a> function of the <a class="el" href="struct_sntp_authentication_interface__t.html">SntpAuthenticationInterface_t</a> interface.</dd>
<dd>
On receiving a successful server response containing server time, this API calculates the clock offset value of the system clock relative to the server before calling the user-defined <a class="el" href="group__sntp__callback__types.html#gade7b1a15684e1272ef7dbb9e4486c285">SntpSetTime_t</a> function for updating the system time.</dd>
<dd>
For correct calculation of clock-offset, the server and client times MUST be within ~68 years (or 2^31 seconds) of each other. In the special case when the server and client times are exactly 2^31 seconds apart, the library ASSUMES that the server time is ahead of the client time, and returns the positive clock-offset value of INT32_MAX seconds.</dd>
<dd>
This API will rotate the server of use in the library for the next time request (through the <a class="el" href="core__sntp__client_8h.html#ae6cb1fe85cff973b2cfa73751adb4062">Sntp_SendTimeRequest</a>) if either of following events occur:<ul>
<li>The server has responded with a rejection for the time request. OR</li>
<li>The server response wait has timed out. If all the servers configured in the context have been used, the API will rotate server for time query back to the first server in the list which will be used in next time request.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pContext</td><td>The context representing an SNTPv4 client. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blockTimeMs</td><td>The maximum duration of time (in milliseconds) the function will block on receiving a response from the server unless either the response is received OR a response timeout occurs.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function can be called multiple times with zero or small blocking times to poll whether server response is received until either the response response is received from the server OR a response timeout has occurred.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>This API functions returns one of the following:<ul>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a8486f9ee1815b43418a9c0478bd8f016" title="Successful operation of an SNTP API.">SntpSuccess</a> if a successful server response is received.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798afc6ed7e8936aa676762523ba8a308e24" title="The SNTP context passed to Sntp_SendTimeRequest or Sntp_ReceiveTimeResponse APIs is is uninitialized.">SntpErrorContextNotInitialized</a> if an uninitialized or invalid context is passed to the function.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a1829c0158e4f2630b6806afa4511dfd7" title="Invalid parameter passed to an API function.">SntpErrorBadParameter</a> if an invalid context is passed to the function.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a6dd0fee9073c6d7c55be89f1bc58b843" title="Networking operation of sending or receiving SNTP packet through the user-defined UDP transport inter...">SntpErrorNetworkFailure</a> if there is a failure in the user-defined transport</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a6db2603ebf3153c9472d3867694aa787" title="Failure from the user-supplied authentication interface, SntpAuthenticationInterface_t,...">SntpErrorAuthFailure</a> if an internal error occurs in the user-defined authentication interface when validating the server response.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798acbefde33f8de7f9fac2c31d6a6008397" title="Time server is not authenticated from the authentication data in its response. This status can be ret...">SntpServerNotAuthenticated</a> when the server could not be authenticated from its response with the user-defined authentication interface.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a4a4f61809052a98c2877cf5035ccc62c" title="Server response failed validation checks for expected data in SNTP packet.">SntpInvalidResponse</a> if the server response fails sanity checks expected in an SNTP response packet.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a379667af0482f651b5630fcc149d9952" title="A timeout has occurred in receiving server response with the Sntp_ReceiveTimeResponse API.">SntpErrorResponseTimeout</a> if a timeout has occurred in receiving response from the server.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798ac03ea3068c8293cf7eea8468d8c12324" title="Server sent a Kiss-o&#39;-Death message to reject the request for time. This status can be returned by th...">SntpRejectedResponse</a> if the server responded with a rejection for the time request.</li>
</ul>
</dd></dl>
<p>For an example POSIX application of the coreSNTP library APIs to create an SNTP client, refer to <a class="el" href="code_example.html">Example application of using coreSNTP APIs</a>. Below is the part of the example application relevant to the <a class="el" href="core__sntp__client_8h.html#ab077d90d19e70a33ab08b31f48728ba5">Sntp_ReceiveTimeResponse</a> API. </p><div class="fragment"><div class="line">    <span class="keywordflow">while</span>( 1 )</div>
<div class="line">    {</div>
<div class="line">        status = <a class="code hl_function" href="core__sntp__client_8c.html#ae6cb1fe85cff973b2cfa73751adb4062">Sntp_SendTimeRequest</a>( &amp;context,</div>
<div class="line">                                       rand() % UINT32_MAX,</div>
<div class="line">                                       TIME_REQUEST_SEND_WAIT_TIME_MS );</div>
<div class="line">        assert( status == <a class="code hl_enumvalue" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a8486f9ee1815b43418a9c0478bd8f016">SntpSuccess</a> );</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">do</span></div>
<div class="line">        {</div>
<div class="line">            status = <a class="code hl_function" href="core__sntp__client_8c.html#ab077d90d19e70a33ab08b31f48728ba5">Sntp_ReceiveTimeResponse</a>( &amp;context, TIME_REQUEST_RECEIVE_WAIT_TIME_MS );</div>
<div class="line">        } <span class="keywordflow">while</span>( status == <a class="code hl_enumvalue" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a473ea25a626b0ab1067a9887e49d113e">SntpNoResponseReceived</a> );</div>
<div class="line"> </div>
<div class="line">        assert( status == <a class="code hl_enumvalue" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a8486f9ee1815b43418a9c0478bd8f016">SntpSuccess</a> );</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Delay of poll interval period before next time synchronization. */</span></div>
<div class="line">        sleep( pollingIntervalPeriod );</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="ttc" id="acore__sntp__client_8c_html_ab077d90d19e70a33ab08b31f48728ba5"><div class="ttname"><a href="core__sntp__client_8c.html#ab077d90d19e70a33ab08b31f48728ba5">Sntp_ReceiveTimeResponse</a></div><div class="ttdeci">SntpStatus_t Sntp_ReceiveTimeResponse(SntpContext_t *pContext, uint32_t blockTimeMs)</div><div class="ttdoc">Receives a time response from the server that has been requested for time with the Sntp_SendTimeReque...</div><div class="ttdef"><b>Definition:</b> core_sntp_client.c:815</div></div>
<div class="ttc" id="acore__sntp__client_8c_html_ae6cb1fe85cff973b2cfa73751adb4062"><div class="ttname"><a href="core__sntp__client_8c.html#ae6cb1fe85cff973b2cfa73751adb4062">Sntp_SendTimeRequest</a></div><div class="ttdeci">SntpStatus_t Sntp_SendTimeRequest(SntpContext_t *pContext, uint32_t randomNumber, uint32_t blockTimeMs)</div><div class="ttdoc">Sends a request for time from the currently configured server (in the context). If the user has provi...</div><div class="ttdef"><b>Definition:</b> core_sntp_client.c:427</div></div>
<div class="ttc" id="agroup__sntp__enum__types_html_ggaef7b22d8008bbfbbc7bbea5a7a30e798a473ea25a626b0ab1067a9887e49d113e"><div class="ttname"><a href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a473ea25a626b0ab1067a9887e49d113e">SntpNoResponseReceived</a></div><div class="ttdeci">@ SntpNoResponseReceived</div><div class="ttdoc">No SNTP packet for server response is received from the network by the Sntp_ReceiveTimeResponse API.</div><div class="ttdef"><b>Definition:</b> core_sntp_serializer.h:240</div></div>
<div class="ttc" id="agroup__sntp__enum__types_html_ggaef7b22d8008bbfbbc7bbea5a7a30e798a8486f9ee1815b43418a9c0478bd8f016"><div class="ttname"><a href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a8486f9ee1815b43418a9c0478bd8f016">SntpSuccess</a></div><div class="ttdeci">@ SntpSuccess</div><div class="ttdoc">Successful operation of an SNTP API.</div><div class="ttdef"><b>Definition:</b> core_sntp_serializer.h:142</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>

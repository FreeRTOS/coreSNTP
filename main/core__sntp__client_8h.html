<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>coreSNTP: core_sntp_client.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">coreSNTP<span id="projectnumber">&#160;v1.1.1</span>
   </div>
   <div id="projectbrief">Client library for synchronizing device time with internet time using Simple Network Time Protocol (SNTP)</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('core__sntp__client_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">core_sntp_client.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>API of an SNTPv4 client library that can send time requests and receive time response to/from SNTP/NTP servers. The library follows the Best Practices suggested in the the SNTPv4 specification, <a href="https://tools.ietf.org/html/rfc4330">RFC 4330</a>. The library can be used to run an SNTP client in a dedicated deamon task to periodically synchronize time from the Internet.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &quot;<a class="el" href="core__sntp__serializer_8h_source.html">core_sntp_serializer.h</a>&quot;</code><br />
</div>
<p><a href="core__sntp__client_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sntp_server_info__t.html">SntpServerInfo_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure representing information for a time server.  <a href="struct_sntp_server_info__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_udp_transport_interface__t.html">UdpTransportInterface_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct representing the UDP transport interface for user-defined functions that coreSNTP library depends on for performing read/write network operations.  <a href="struct_udp_transport_interface__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sntp_authentication_interface__t.html">SntpAuthenticationInterface_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct representing the authentication interface for securely communicating with time servers.  <a href="struct_sntp_authentication_interface__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sntp_context__t.html">SntpContext_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for a context that stores state for managing a long-running SNTP client that periodically polls time and synchronizes system clock.  <a href="struct_sntp_context__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga6664b646f80b100c83825f159d0e5bd2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sntp__constants.html#ga6664b646f80b100c83825f159d0e5bd2">SNTP_DEFAULT_SERVER_PORT</a>&#160;&#160;&#160;( 123U )</td></tr>
<tr class="memdesc:ga6664b646f80b100c83825f159d0e5bd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The default UDP port supported by SNTP/NTP servers for client-server communication.  <a href="group__sntp__constants.html#ga6664b646f80b100c83825f159d0e5bd2">More...</a><br /></td></tr>
<tr class="separator:ga6664b646f80b100c83825f159d0e5bd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaef268b4cc2cf00e3e573b637cde7c09e"><td class="memItemLeft" align="right" valign="top">typedef bool(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sntp__callback__types.html#gaef268b4cc2cf00e3e573b637cde7c09e">SntpResolveDns_t</a>) (const <a class="el" href="struct_sntp_server_info__t.html">SntpServerInfo_t</a> *pServerAddr, uint32_t *pIpV4Addr)</td></tr>
<tr class="memdesc:gaef268b4cc2cf00e3e573b637cde7c09e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface for user-defined function to resolve time server domain-name to an IPv4 address. The SNTP client library attempts to resolve the DNS of the time-server being used every time the <a class="el" href="core__sntp__client_8h.html#ae6cb1fe85cff973b2cfa73751adb4062">Sntp_SendTimeRequest</a> API is called.  <a href="group__sntp__callback__types.html#gaef268b4cc2cf00e3e573b637cde7c09e">More...</a><br /></td></tr>
<tr class="separator:gaef268b4cc2cf00e3e573b637cde7c09e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e30d57887e46bee4074a5ba62f681e8"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sntp__callback__types.html#ga1e30d57887e46bee4074a5ba62f681e8">SntpGetTime_t</a>) (<a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *pCurrentTime)</td></tr>
<tr class="memdesc:ga1e30d57887e46bee4074a5ba62f681e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface for user-defined function to obtain the current system time in SNTP timestamp format.  <a href="group__sntp__callback__types.html#ga1e30d57887e46bee4074a5ba62f681e8">More...</a><br /></td></tr>
<tr class="separator:ga1e30d57887e46bee4074a5ba62f681e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gade7b1a15684e1272ef7dbb9e4486c285"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sntp__callback__types.html#gade7b1a15684e1272ef7dbb9e4486c285">SntpSetTime_t</a>) (const <a class="el" href="struct_sntp_server_info__t.html">SntpServerInfo_t</a> *pTimeServer, const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *pServerTime, int64_t clockOffsetMs, <a class="el" href="group__sntp__enum__types.html#ga69e2cb17ab4e253491602ccfe48b141f">SntpLeapSecondInfo_t</a> leapSecondInfo)</td></tr>
<tr class="memdesc:gade7b1a15684e1272ef7dbb9e4486c285"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface for user-defined function to update the system clock time so that it is synchronized the time server used for getting current time.  <a href="group__sntp__callback__types.html#gade7b1a15684e1272ef7dbb9e4486c285">More...</a><br /></td></tr>
<tr class="separator:gade7b1a15684e1272ef7dbb9e4486c285"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7769e434e7811caed8cd6fd7f9ec26ec"><td class="memItemLeft" align="right" valign="top">
typedef struct NetworkContext&#160;</td><td class="memItemRight" valign="bottom"><b>NetworkContext_t</b></td></tr>
<tr class="memdesc:ga7769e434e7811caed8cd6fd7f9ec26ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">A user-defined type for context that is passed to the transport interface functions. It MUST be defined by the user to use the library. It is of incomplete type to allow user to define to the needs of their transport interface implementation. <br /></td></tr>
<tr class="separator:ga7769e434e7811caed8cd6fd7f9ec26ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaadd728af5c040252f0b7224e72ea771f"><td class="memItemLeft" align="right" valign="top">typedef int32_t(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sntp__callback__types.html#gaadd728af5c040252f0b7224e72ea771f">UdpTransportSendTo_t</a>) (<a class="el" href="group__sntp__struct__types.html#ga7769e434e7811caed8cd6fd7f9ec26ec">NetworkContext_t</a> *pNetworkContext, uint32_t serverAddr, uint16_t serverPort, const void *pBuffer, uint16_t bytesToSend)</td></tr>
<tr class="memdesc:gaadd728af5c040252f0b7224e72ea771f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface for user-defined function to send time request as a single datagram to server on the network over User Datagram Protocol (UDP).  <a href="group__sntp__callback__types.html#gaadd728af5c040252f0b7224e72ea771f">More...</a><br /></td></tr>
<tr class="separator:gaadd728af5c040252f0b7224e72ea771f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga138d8e928110f9b0cbc214135c91b344"><td class="memItemLeft" align="right" valign="top">typedef int32_t(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sntp__callback__types.html#ga138d8e928110f9b0cbc214135c91b344">UdpTransportRecvFrom_t</a>) (<a class="el" href="group__sntp__struct__types.html#ga7769e434e7811caed8cd6fd7f9ec26ec">NetworkContext_t</a> *pNetworkContext, uint32_t serverAddr, uint16_t serverPort, void *pBuffer, uint16_t bytesToRecv)</td></tr>
<tr class="memdesc:ga138d8e928110f9b0cbc214135c91b344"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface for user-defined function to receive the server response, to a time request (sent through the <a class="el" href="group__sntp__callback__types.html#gaadd728af5c040252f0b7224e72ea771f">UdpTransportSendTo_t</a> function), from the network over User Datagram Protocol (UDP).  <a href="group__sntp__callback__types.html#ga138d8e928110f9b0cbc214135c91b344">More...</a><br /></td></tr>
<tr class="separator:ga138d8e928110f9b0cbc214135c91b344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaff243b342eebc2622fbb493d08663133"><td class="memItemLeft" align="right" valign="top">
typedef struct SntpAuthContext&#160;</td><td class="memItemRight" valign="bottom"><b>SntpAuthContext_t</b></td></tr>
<tr class="memdesc:gaff243b342eebc2622fbb493d08663133"><td class="mdescLeft">&#160;</td><td class="mdescRight">A user-defined type for context that is passed to the authentication interface functions. It MUST be defined by the user to use the library. It is of incomplete type to allow user to defined to the the needs of their authentication interface implementation. <br /></td></tr>
<tr class="separator:gaff243b342eebc2622fbb493d08663133"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7f01446c0d655614b99fd4043c8f032a"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sntp__callback__types.html#ga7f01446c0d655614b99fd4043c8f032a">SntpGenerateAuthCode_t</a>) (<a class="el" href="group__sntp__struct__types.html#gaff243b342eebc2622fbb493d08663133">SntpAuthContext_t</a> *pContext, const <a class="el" href="struct_sntp_server_info__t.html">SntpServerInfo_t</a> *pTimeServer, void *pBuffer, size_t bufferSize, uint16_t *pAuthCodeSize)</td></tr>
<tr class="memdesc:ga7f01446c0d655614b99fd4043c8f032a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface for user-defined function to generate and append authentication code in an SNTP request buffer for the SNTP client to be authenticated by the time server, if a security mechanism is used.  <a href="group__sntp__callback__types.html#ga7f01446c0d655614b99fd4043c8f032a">More...</a><br /></td></tr>
<tr class="separator:ga7f01446c0d655614b99fd4043c8f032a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae382a67b0ffbb4721d8d599efe3020c4"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__sntp__callback__types.html#gae382a67b0ffbb4721d8d599efe3020c4">SntpValidateServerAuth_t</a>) (<a class="el" href="group__sntp__struct__types.html#gaff243b342eebc2622fbb493d08663133">SntpAuthContext_t</a> *pContext, const <a class="el" href="struct_sntp_server_info__t.html">SntpServerInfo_t</a> *pTimeServer, const void *pResponseData, uint16_t responseSize)</td></tr>
<tr class="memdesc:gae382a67b0ffbb4721d8d599efe3020c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface for user-defined function to authenticate server by validating the authentication code present in its SNTP response to a time request, if a security mechanism is supported by the server.  <a href="group__sntp__callback__types.html#gae382a67b0ffbb4721d8d599efe3020c4">More...</a><br /></td></tr>
<tr class="separator:gae382a67b0ffbb4721d8d599efe3020c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae7f3fa647cd74f09878af88e430707fc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__client_8h.html#ae7f3fa647cd74f09878af88e430707fc">Sntp_Init</a> (<a class="el" href="struct_sntp_context__t.html">SntpContext_t</a> *pContext, const <a class="el" href="struct_sntp_server_info__t.html">SntpServerInfo_t</a> *pTimeServers, size_t numOfServers, uint32_t serverResponseTimeoutMs, uint8_t *pNetworkBuffer, size_t bufferSize, <a class="el" href="group__sntp__callback__types.html#gaef268b4cc2cf00e3e573b637cde7c09e">SntpResolveDns_t</a> resolveDnsFunc, <a class="el" href="group__sntp__callback__types.html#ga1e30d57887e46bee4074a5ba62f681e8">SntpGetTime_t</a> getSystemTimeFunc, <a class="el" href="group__sntp__callback__types.html#gade7b1a15684e1272ef7dbb9e4486c285">SntpSetTime_t</a> setSystemTimeFunc, const <a class="el" href="struct_udp_transport_interface__t.html">UdpTransportInterface_t</a> *pTransportIntf, const <a class="el" href="struct_sntp_authentication_interface__t.html">SntpAuthenticationInterface_t</a> *pAuthIntf)</td></tr>
<tr class="memdesc:ae7f3fa647cd74f09878af88e430707fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a context for SNTP client communication with SNTP/NTP servers.  <a href="core__sntp__client_8h.html#ae7f3fa647cd74f09878af88e430707fc">More...</a><br /></td></tr>
<tr class="separator:ae7f3fa647cd74f09878af88e430707fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6cb1fe85cff973b2cfa73751adb4062"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__client_8h.html#ae6cb1fe85cff973b2cfa73751adb4062">Sntp_SendTimeRequest</a> (<a class="el" href="struct_sntp_context__t.html">SntpContext_t</a> *pContext, uint32_t randomNumber, uint32_t blockTimeMs)</td></tr>
<tr class="memdesc:ae6cb1fe85cff973b2cfa73751adb4062"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a request for time from the currently configured server (in the context). If the user has provided an authentication interface, the client authentication code is appended to the request before sending over the network by calling the <a class="el" href="group__sntp__callback__types.html#ga7f01446c0d655614b99fd4043c8f032a">SntpGenerateAuthCode_t</a> function of the <a class="el" href="struct_sntp_authentication_interface__t.html">SntpAuthenticationInterface_t</a>.  <a href="core__sntp__client_8h.html#ae6cb1fe85cff973b2cfa73751adb4062">More...</a><br /></td></tr>
<tr class="separator:ae6cb1fe85cff973b2cfa73751adb4062"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab077d90d19e70a33ab08b31f48728ba5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__client_8h.html#ab077d90d19e70a33ab08b31f48728ba5">Sntp_ReceiveTimeResponse</a> (<a class="el" href="struct_sntp_context__t.html">SntpContext_t</a> *pContext, uint32_t blockTimeMs)</td></tr>
<tr class="memdesc:ab077d90d19e70a33ab08b31f48728ba5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receives a time response from the server that has been requested for time with the <a class="el" href="core__sntp__client_8h.html#ae6cb1fe85cff973b2cfa73751adb4062">Sntp_SendTimeRequest</a> API function. Once an accepted response containing time from server is received, this function calls the user-defined <a class="el" href="group__sntp__callback__types.html#gade7b1a15684e1272ef7dbb9e4486c285">SntpSetTime_t</a> function to update the system time.  <a href="core__sntp__client_8h.html#ab077d90d19e70a33ab08b31f48728ba5">More...</a><br /></td></tr>
<tr class="separator:ab077d90d19e70a33ab08b31f48728ba5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a636a84baa528354ea6115e6af2c46eed"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__client_8h.html#a636a84baa528354ea6115e6af2c46eed">Sntp_StatusToStr</a> (<a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a> status)</td></tr>
<tr class="memdesc:a636a84baa528354ea6115e6af2c46eed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts <a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a> to its equivalent string.  <a href="core__sntp__client_8h.html#a636a84baa528354ea6115e6af2c46eed">More...</a><br /></td></tr>
<tr class="separator:a636a84baa528354ea6115e6af2c46eed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >API of an SNTPv4 client library that can send time requests and receive time response to/from SNTP/NTP servers. The library follows the Best Practices suggested in the the SNTPv4 specification, <a href="https://tools.ietf.org/html/rfc4330">RFC 4330</a>. The library can be used to run an SNTP client in a dedicated deamon task to periodically synchronize time from the Internet. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae7f3fa647cd74f09878af88e430707fc" name="ae7f3fa647cd74f09878af88e430707fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7f3fa647cd74f09878af88e430707fc">&#9670;&nbsp;</a></span>Sntp_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a> Sntp_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sntp_context__t.html">SntpContext_t</a> *&#160;</td>
          <td class="paramname"><em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sntp_server_info__t.html">SntpServerInfo_t</a> *&#160;</td>
          <td class="paramname"><em>pTimeServers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>numOfServers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>serverResponseTimeoutMs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pNetworkBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>bufferSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__sntp__callback__types.html#gaef268b4cc2cf00e3e573b637cde7c09e">SntpResolveDns_t</a>&#160;</td>
          <td class="paramname"><em>resolveDnsFunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__sntp__callback__types.html#ga1e30d57887e46bee4074a5ba62f681e8">SntpGetTime_t</a>&#160;</td>
          <td class="paramname"><em>getSystemTimeFunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__sntp__callback__types.html#gade7b1a15684e1272ef7dbb9e4486c285">SntpSetTime_t</a>&#160;</td>
          <td class="paramname"><em>setSystemTimeFunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_udp_transport_interface__t.html">UdpTransportInterface_t</a> *&#160;</td>
          <td class="paramname"><em>pTransportIntf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sntp_authentication_interface__t.html">SntpAuthenticationInterface_t</a> *&#160;</td>
          <td class="paramname"><em>pAuthIntf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a context for SNTP client communication with SNTP/NTP servers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pContext</td><td>The user-supplied memory for the context that will be initialized to represent an SNTP client. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pTimeServers</td><td>The list of decreasing order of priority of time servers that should be used by the SNTP client. This list MUST stay in scope for all the time of use of the context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numOfServers</td><td>The number of servers in the list, <code>pTimeServers</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">serverResponseTimeoutMs</td><td>The timeout duration (in milliseconds) for receiving server response for time requests. The same timeout value is used for each server in the <code>pTimeServers</code> list. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pNetworkBuffer</td><td>The user-supplied memory that will be used for storing network data for SNTP client-server communication. The buffer MUST stay in scope for all the time of use of the context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bufferSize</td><td>The size of the passed buffer <code>pNetworkBuffer</code>. The buffer SHOULD be appropriately sized for storing an entire SNTP packet which includes both <a class="el" href="group__sntp__constants.html#ga9fb0febdb6e2f2dff2e133ef49ce205b" title="The base packet size of request and response of the (S)NTP protocol.">SNTP_PACKET_BASE_SIZE</a> bytes of standard SNTP packet size, and space for authentication data, if security mechanism is used to communicate with any of the time servers configured for use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">resolveDnsFunc</td><td>The user-defined function for DNS resolution of time server. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">getSystemTimeFunc</td><td>The user-defined function for querying system time. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">setSystemTimeFunc</td><td>The user-defined function for correcting system time for every successful time response received from a server. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pTransportIntf</td><td>The user-defined function for performing network send/recv operations over UDP. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pAuthIntf</td><td>The user-defined interface for generating client authentication in SNTP requests and authenticating servers in SNTP responses, if security mechanism is used in SNTP communication with server(s). If security mechanism is not used in communication with any of the configured servers (in <code>pTimeServers</code>), then the <a class="el" href="struct_sntp_authentication_interface__t.html">SntpAuthenticationInterface_t</a> does not need to be defined and this parameter can be NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function returns one of the following:<ul>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a8486f9ee1815b43418a9c0478bd8f016" title="Successful operation of an SNTP API.">SntpSuccess</a> if the context is initialized.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a1829c0158e4f2630b6806afa4511dfd7" title="Invalid parameter passed to an API function.">SntpErrorBadParameter</a> if any of the passed parameters in invalid.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a23891833ba2ad8634832cbbb9d47bd9c" title="Application provided insufficient buffer space for serializing or de-serializing an SNTP packet....">SntpErrorBufferTooSmall</a> if the buffer does not have the minimum size required for a valid SNTP response packet. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="ae6cb1fe85cff973b2cfa73751adb4062" name="ae6cb1fe85cff973b2cfa73751adb4062"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6cb1fe85cff973b2cfa73751adb4062">&#9670;&nbsp;</a></span>Sntp_SendTimeRequest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a> Sntp_SendTimeRequest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sntp_context__t.html">SntpContext_t</a> *&#160;</td>
          <td class="paramname"><em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>randomNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>blockTimeMs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a request for time from the currently configured server (in the context). If the user has provided an authentication interface, the client authentication code is appended to the request before sending over the network by calling the <a class="el" href="group__sntp__callback__types.html#ga7f01446c0d655614b99fd4043c8f032a">SntpGenerateAuthCode_t</a> function of the <a class="el" href="struct_sntp_authentication_interface__t.html">SntpAuthenticationInterface_t</a>. </p>
<dl class="section note"><dt>Note</dt><dd>This function will ONLY send a request if there is a server available in the configured list that has not rejected an earlier request for time. This adheres to the Best Practice functionality specified in <a href="https://tools.ietf.org/html/rfc4330#section-10">Section 10 Point 8 of SNTPv4 specification</a>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pContext</td><td>The context representing an SNTPv4 client. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">randomNumber</td><td>A random number serializing the SNTP request packet to protect against spoofing attacks by attackers that are off the network path of the SNTP client-server communication. This mechanism is suggested by SNTPv4 specification in <a href="https://tools.ietf.org/html/rfc4330#section-3">RFC 4330 Section 3</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blockTimeMs</td><td>The maximum duration of time (in milliseconds) the function will block on attempting to send time request to the server over the network. If a zero block time value is provided, then the function will attempt to send the packet ONLY once.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>It is RECOMMENDED that a True Random Number Generator is used to generate the random number by using a hardware module, like Hardware Security Module (HSM), Secure Element, etc, as the entropy source.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>The API function returns one of the following:<ul>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a8486f9ee1815b43418a9c0478bd8f016" title="Successful operation of an SNTP API.">SntpSuccess</a> if a time request is successfully sent to the currently configured time server in the context.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a1829c0158e4f2630b6806afa4511dfd7" title="Invalid parameter passed to an API function.">SntpErrorBadParameter</a> if an invalid context is passed to the function.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798afc6ed7e8936aa676762523ba8a308e24" title="The SNTP context passed to Sntp_SendTimeRequest or Sntp_ReceiveTimeResponse APIs is is uninitialized.">SntpErrorContextNotInitialized</a> if an uninitialized or invalid context is passed to the function.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a71c91750cf5069fc4223e4aaf0a5d4f0" title="The user-defined DNS resolution interface, SntpResolveDns_t, failed to resolve address for a time ser...">SntpErrorDnsFailure</a> if there is failure in the user-defined function for DNS resolution of the time server.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a6dd0fee9073c6d7c55be89f1bc58b843" title="Networking operation of sending or receiving SNTP packet through the user-defined UDP transport inter...">SntpErrorNetworkFailure</a> if the SNTP request could not be sent over the network through the user-defined transport interface.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a6db2603ebf3153c9472d3867694aa787" title="Failure from the user-supplied authentication interface, SntpAuthenticationInterface_t,...">SntpErrorAuthFailure</a> if there was a failure in generating the client authentication code in the user-defined authentication interface.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a0e41141d4e0b0f1bf945830f7f2c6be9" title="A timeout occurred in sending time request packet over the network to a server through the Sntp_SendT...">SntpErrorSendTimeout</a> if the time request packet could not be sent over the network for the entire <code>blockTimeMs</code> duration. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="ab077d90d19e70a33ab08b31f48728ba5" name="ab077d90d19e70a33ab08b31f48728ba5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab077d90d19e70a33ab08b31f48728ba5">&#9670;&nbsp;</a></span>Sntp_ReceiveTimeResponse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a> Sntp_ReceiveTimeResponse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sntp_context__t.html">SntpContext_t</a> *&#160;</td>
          <td class="paramname"><em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>blockTimeMs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receives a time response from the server that has been requested for time with the <a class="el" href="core__sntp__client_8h.html#ae6cb1fe85cff973b2cfa73751adb4062">Sntp_SendTimeRequest</a> API function. Once an accepted response containing time from server is received, this function calls the user-defined <a class="el" href="group__sntp__callback__types.html#gade7b1a15684e1272ef7dbb9e4486c285">SntpSetTime_t</a> function to update the system time. </p>
<dl class="section note"><dt>Note</dt><dd>If the user has provided an authentication interface to the client (through <a class="el" href="core__sntp__client_8h.html#ae7f3fa647cd74f09878af88e430707fc">Sntp_Init</a>), the server response is authenticated by calling the <a class="el" href="group__sntp__callback__types.html#gae382a67b0ffbb4721d8d599efe3020c4">SntpValidateServerAuth_t</a> function of the <a class="el" href="struct_sntp_authentication_interface__t.html">SntpAuthenticationInterface_t</a> interface.</dd>
<dd>
On receiving a successful server response containing server time, this API calculates the clock offset value of the system clock relative to the server before calling the user-defined <a class="el" href="group__sntp__callback__types.html#gade7b1a15684e1272ef7dbb9e4486c285">SntpSetTime_t</a> function for updating the system time.</dd>
<dd>
For correct calculation of clock-offset, the server and client times MUST be within ~68 years (or 2^31 seconds) of each other. In the special case when the server and client times are exactly 2^31 seconds apart, the library ASSUMES that the server time is ahead of the client time, and returns the positive clock-offset value of INT32_MAX seconds.</dd>
<dd>
This API will rotate the server of use in the library for the next time request (through the <a class="el" href="core__sntp__client_8h.html#ae6cb1fe85cff973b2cfa73751adb4062">Sntp_SendTimeRequest</a>) if either of following events occur:<ul>
<li>The server has responded with a rejection for the time request. OR</li>
<li>The server response wait has timed out. If all the servers configured in the context have been used, the API will rotate server for time query back to the first server in the list which will be used in next time request.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pContext</td><td>The context representing an SNTPv4 client. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">blockTimeMs</td><td>The maximum duration of time (in milliseconds) the function will block on receiving a response from the server unless either the response is received OR a response timeout occurs.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function can be called multiple times with zero or small blocking times to poll whether server response is received until either the response response is received from the server OR a response timeout has occurred.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>This API functions returns one of the following:<ul>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a8486f9ee1815b43418a9c0478bd8f016" title="Successful operation of an SNTP API.">SntpSuccess</a> if a successful server response is received.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798afc6ed7e8936aa676762523ba8a308e24" title="The SNTP context passed to Sntp_SendTimeRequest or Sntp_ReceiveTimeResponse APIs is is uninitialized.">SntpErrorContextNotInitialized</a> if an uninitialized or invalid context is passed to the function.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a1829c0158e4f2630b6806afa4511dfd7" title="Invalid parameter passed to an API function.">SntpErrorBadParameter</a> if an invalid context is passed to the function.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a6dd0fee9073c6d7c55be89f1bc58b843" title="Networking operation of sending or receiving SNTP packet through the user-defined UDP transport inter...">SntpErrorNetworkFailure</a> if there is a failure in the user-defined transport</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a6db2603ebf3153c9472d3867694aa787" title="Failure from the user-supplied authentication interface, SntpAuthenticationInterface_t,...">SntpErrorAuthFailure</a> if an internal error occurs in the user-defined authentication interface when validating the server response.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798acbefde33f8de7f9fac2c31d6a6008397" title="Time server is not authenticated from the authentication data in its response. This status can be ret...">SntpServerNotAuthenticated</a> when the server could not be authenticated from its response with the user-defined authentication interface.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a4a4f61809052a98c2877cf5035ccc62c" title="Server response failed validation checks for expected data in SNTP packet.">SntpInvalidResponse</a> if the server response fails sanity checks expected in an SNTP response packet.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a379667af0482f651b5630fcc149d9952" title="A timeout has occurred in receiving server response with the Sntp_ReceiveTimeResponse API.">SntpErrorResponseTimeout</a> if a timeout has occurred in receiving response from the server.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798ac03ea3068c8293cf7eea8468d8c12324" title="Server sent a Kiss-o&#39;-Death message to reject the request for time. This status can be returned by th...">SntpRejectedResponse</a> if the server responded with a rejection for the time request. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="a636a84baa528354ea6115e6af2c46eed" name="a636a84baa528354ea6115e6af2c46eed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a636a84baa528354ea6115e6af2c46eed">&#9670;&nbsp;</a></span>Sntp_StatusToStr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * Sntp_StatusToStr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a>&#160;</td>
          <td class="paramname"><em>status</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts <a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a> to its equivalent string. </p>
<dl class="section note"><dt>Note</dt><dd>The returned string MUST NOT be modified.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">status</td><td>The status to convert to a string.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The string representation of the status code. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="dir_8ee1a5e78eaec319fe5d64075812fc61.html">include</a></li><li class="navelem"><a class="el" href="core__sntp__client_8h.html">core_sntp_client.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>coreSNTP: core_sntp_serializer.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">coreSNTP<span id="projectnumber">&#160;v1.1.1</span>
   </div>
   <div id="projectbrief">Client library for synchronizing device time with internet time using Simple Network Time Protocol (SNTP)</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('core__sntp__serializer_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">core_sntp_serializer.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of the Serializer API of the coreSNTP library.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &quot;<a class="el" href="core__sntp__serializer_8h_source.html">core_sntp_serializer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="core__sntp__config__defaults_8h_source.html">core_sntp_config_defaults.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_sntp_packet__t.html">SntpPacket_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure representing an SNTP packet header. For more information on SNTP packet format, refer to <a href="https://tools.ietf.org/html/rfc4330#section-4">RFC 4330 Section 4</a>.  <a href="struct_sntp_packet__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a2d502c8fc2a1bc349e042013e912d304"><td class="memItemLeft" align="right" valign="top"><a id="a2d502c8fc2a1bc349e042013e912d304" name="a2d502c8fc2a1bc349e042013e912d304"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SNTP_VERSION</b>&#160;&#160;&#160;( 4U )</td></tr>
<tr class="memdesc:a2d502c8fc2a1bc349e042013e912d304"><td class="mdescLeft">&#160;</td><td class="mdescRight">The version of SNTP supported by the coreSNTP library by complying with the SNTPv4 specification defined in <a href="https://tools.ietf.org/html/rfc4330">RFC 4330</a>. <br /></td></tr>
<tr class="separator:a2d502c8fc2a1bc349e042013e912d304"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af37cd6171731cf259768c8f49df7c07d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#af37cd6171731cf259768c8f49df7c07d">SNTP_MODE_BITS_MASK</a>&#160;&#160;&#160;( 0x07U )</td></tr>
<tr class="memdesc:af37cd6171731cf259768c8f49df7c07d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The bit mask for the "Mode" information in the first byte of an SNTP packet. The "Mode" field occupies bits 0-2 of the byte.  <a href="core__sntp__serializer_8c.html#af37cd6171731cf259768c8f49df7c07d">More...</a><br /></td></tr>
<tr class="separator:af37cd6171731cf259768c8f49df7c07d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a072e2e8031e031c5668b35fa46824b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#a3a072e2e8031e031c5668b35fa46824b">SNTP_MODE_CLIENT</a>&#160;&#160;&#160;( 3U )</td></tr>
<tr class="memdesc:a3a072e2e8031e031c5668b35fa46824b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The value indicating a "client" in the "Mode" field of an SNTP packet.  <a href="core__sntp__serializer_8c.html#a3a072e2e8031e031c5668b35fa46824b">More...</a><br /></td></tr>
<tr class="separator:a3a072e2e8031e031c5668b35fa46824b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a229d48673de40e21a9ec8384f248149c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#a229d48673de40e21a9ec8384f248149c">SNTP_MODE_SERVER</a>&#160;&#160;&#160;( 4U )</td></tr>
<tr class="memdesc:a229d48673de40e21a9ec8384f248149c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The value indicating a "server" in the "Mode" field of an SNTP packet.  <a href="core__sntp__serializer_8c.html#a229d48673de40e21a9ec8384f248149c">More...</a><br /></td></tr>
<tr class="separator:a229d48673de40e21a9ec8384f248149c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada3c4bedf99dbf21c47a885a3b0ed743"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#ada3c4bedf99dbf21c47a885a3b0ed743">SNTP_LEAP_INDICATOR_LSB_POSITION</a>&#160;&#160;&#160;( 6 )</td></tr>
<tr class="memdesc:ada3c4bedf99dbf21c47a885a3b0ed743"><td class="mdescLeft">&#160;</td><td class="mdescRight">The position of the least significant bit of the "Leap Indicator" field in first byte of an SNTP packet. The "Leap Indicator" field occupies bits 6-7 of the byte.  <a href="core__sntp__serializer_8c.html#ada3c4bedf99dbf21c47a885a3b0ed743">More...</a><br /></td></tr>
<tr class="separator:ada3c4bedf99dbf21c47a885a3b0ed743"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5be232b273bff9e7984120b31de0e46a"><td class="memItemLeft" align="right" valign="top"><a id="a5be232b273bff9e7984120b31de0e46a" name="a5be232b273bff9e7984120b31de0e46a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SNTP_KISS_OF_DEATH_STRATUM</b>&#160;&#160;&#160;( 0U )</td></tr>
<tr class="memdesc:a5be232b273bff9e7984120b31de0e46a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Value of Stratum field in SNTP packet representing a Kiss-o'-Death message from server. <br /></td></tr>
<tr class="separator:a5be232b273bff9e7984120b31de0e46a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70e864486560dd0a7728b1fdb66ec20c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#a70e864486560dd0a7728b1fdb66ec20c">SNTP_VERSION_LSB_POSITION</a>&#160;&#160;&#160;( 3 )</td></tr>
<tr class="memdesc:a70e864486560dd0a7728b1fdb66ec20c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The position of least significant bit of the "Version" information in the first byte of an SNTP packet. "Version" field occupies bits 3-5 of the byte.  <a href="core__sntp__serializer_8c.html#a70e864486560dd0a7728b1fdb66ec20c">More...</a><br /></td></tr>
<tr class="separator:a70e864486560dd0a7728b1fdb66ec20c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94fde0de05774acb7fe61517ca7e9702"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#a94fde0de05774acb7fe61517ca7e9702">KOD_CODE_DENY_UINT_VALUE</a>&#160;&#160;&#160;( 0x44454e59U )</td></tr>
<tr class="memdesc:a94fde0de05774acb7fe61517ca7e9702"><td class="mdescLeft">&#160;</td><td class="mdescRight">The integer value of the Kiss-o'-Death ASCII code, "DENY", used for comparison with data in an SNTP response.  <a href="core__sntp__serializer_8c.html#a94fde0de05774acb7fe61517ca7e9702">More...</a><br /></td></tr>
<tr class="separator:a94fde0de05774acb7fe61517ca7e9702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60fc8709a28795ae05af7d140ffb79a4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#a60fc8709a28795ae05af7d140ffb79a4">KOD_CODE_RSTR_UINT_VALUE</a>&#160;&#160;&#160;( 0x52535452U )</td></tr>
<tr class="memdesc:a60fc8709a28795ae05af7d140ffb79a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The integer value of the Kiss-o'-Death ASCII code, "RSTR", used for comparison with data in an SNTP response.  <a href="core__sntp__serializer_8c.html#a60fc8709a28795ae05af7d140ffb79a4">More...</a><br /></td></tr>
<tr class="separator:a60fc8709a28795ae05af7d140ffb79a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8f9569b5f0d4c5dfc0cb0cd0842c895"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#ac8f9569b5f0d4c5dfc0cb0cd0842c895">KOD_CODE_RATE_UINT_VALUE</a>&#160;&#160;&#160;( 0x52415445U )</td></tr>
<tr class="memdesc:ac8f9569b5f0d4c5dfc0cb0cd0842c895"><td class="mdescLeft">&#160;</td><td class="mdescRight">The integer value of the Kiss-o'-Death ASCII code, "RATE", used for comparison with data in an SNTP response.  <a href="core__sntp__serializer_8c.html#ac8f9569b5f0d4c5dfc0cb0cd0842c895">More...</a><br /></td></tr>
<tr class="separator:ac8f9569b5f0d4c5dfc0cb0cd0842c895"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaacfadcc9b6655aa09392826d867d0fd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#aaacfadcc9b6655aa09392826d867d0fd">CLOCK_OFFSET_MAX_TIME_DIFFERENCE</a>&#160;&#160;&#160;( ( ( ( int64_t ) INT32_MAX + 1 ) * 1000 ) )</td></tr>
<tr class="memdesc:aaacfadcc9b6655aa09392826d867d0fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macro to represent exactly half of the total number of seconds in an NTP era. As 32 bits are used to represent the "seconds" part of an SNTP timestamp, the half of the total range of seconds in an NTP era is 2^31 seconds, which represents ~68 years.  <a href="core__sntp__serializer_8c.html#aaacfadcc9b6655aa09392826d867d0fd">More...</a><br /></td></tr>
<tr class="separator:aaacfadcc9b6655aa09392826d867d0fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad423a3e191fa073a8a8cb101a2f4474"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#aad423a3e191fa073a8a8cb101a2f4474">TOTAL_MILLISECONDS_IN_NTP_ERA</a>&#160;&#160;&#160;( ( ( int64_t ) UINT32_MAX + 1 ) * 1000 )</td></tr>
<tr class="memdesc:aad423a3e191fa073a8a8cb101a2f4474"><td class="mdescLeft">&#160;</td><td class="mdescRight">Macro to represent the total number of milliseconds that are represented in an NTP era period. This macro represents a duration of ~136 years.  <a href="core__sntp__serializer_8c.html#aad423a3e191fa073a8a8cb101a2f4474">More...</a><br /></td></tr>
<tr class="separator:aad423a3e191fa073a8a8cb101a2f4474"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4d0924478bfb3aa69745bd8974e25b8a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#a4d0924478bfb3aa69745bd8974e25b8a">fillWordMemoryInNetworkOrder</a> (uint32_t *pWordMemory, uint32_t data)</td></tr>
<tr class="memdesc:a4d0924478bfb3aa69745bd8974e25b8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility macro to fill 32-bit integer in word-sized memory in network byte (or Big Endian) order.  <a href="core__sntp__serializer_8c.html#a4d0924478bfb3aa69745bd8974e25b8a">More...</a><br /></td></tr>
<tr class="separator:a4d0924478bfb3aa69745bd8974e25b8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69acf27cf58eff4f2f9a6057e9992781"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#a69acf27cf58eff4f2f9a6057e9992781">readWordFromNetworkByteOrderMemory</a> (const uint32_t *ptr)</td></tr>
<tr class="memdesc:a69acf27cf58eff4f2f9a6057e9992781"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility macro to generate a 32-bit integer from memory containing integer in network (or Big Endian) byte order.  <a href="core__sntp__serializer_8c.html#a69acf27cf58eff4f2f9a6057e9992781">More...</a><br /></td></tr>
<tr class="separator:a69acf27cf58eff4f2f9a6057e9992781"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53e589c52b81e5852c6b56a9b66d5eb2"><td class="memItemLeft" align="right" valign="top">static int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#a53e589c52b81e5852c6b56a9b66d5eb2">absoluteOf</a> (int64_t value)</td></tr>
<tr class="memdesc:a53e589c52b81e5852c6b56a9b66d5eb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility to return absolute (or positively signed) value of an signed 64 bit integer.  <a href="core__sntp__serializer_8c.html#a53e589c52b81e5852c6b56a9b66d5eb2">More...</a><br /></td></tr>
<tr class="separator:a53e589c52b81e5852c6b56a9b66d5eb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04c87586b09d72d7dff92797673eed75"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#a04c87586b09d72d7dff92797673eed75">isZeroTimestamp</a> (const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *pTime)</td></tr>
<tr class="memdesc:a04c87586b09d72d7dff92797673eed75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility to determine whether a timestamp represents a zero timestamp value.  <a href="core__sntp__serializer_8c.html#a04c87586b09d72d7dff92797673eed75">More...</a><br /></td></tr>
<tr class="separator:a04c87586b09d72d7dff92797673eed75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afec85474dae06b84849cd72605c70ca8"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#afec85474dae06b84849cd72605c70ca8">fractionsToMs</a> (uint32_t fractions)</td></tr>
<tr class="memdesc:afec85474dae06b84849cd72605c70ca8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility to convert the "fractions" part of an SNTP timestamp to milliseconds duration of time.  <a href="core__sntp__serializer_8c.html#afec85474dae06b84849cd72605c70ca8">More...</a><br /></td></tr>
<tr class="separator:afec85474dae06b84849cd72605c70ca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8e1e3b85a690e31996bdd2129dd5898"><td class="memItemLeft" align="right" valign="top">static int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#ae8e1e3b85a690e31996bdd2129dd5898">safeTimeDifference</a> (const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *pServerTime, const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *pClientTime)</td></tr>
<tr class="memdesc:ae8e1e3b85a690e31996bdd2129dd5898"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility to safely calculate difference between server and client timestamps and return the difference in the resolution of milliseconds as a signed 64 bit integer. The calculated value represents the effective subtraction as ( <code>serverTimeSec</code> - <code>clientTimeSec</code> ).  <a href="core__sntp__serializer_8c.html#ae8e1e3b85a690e31996bdd2129dd5898">More...</a><br /></td></tr>
<tr class="separator:ae8e1e3b85a690e31996bdd2129dd5898"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f5c6defb25cc21fdcfee67f48606a03"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#a2f5c6defb25cc21fdcfee67f48606a03">calculateClockOffset</a> (const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *pClientTxTime, const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *pServerRxTime, const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *pServerTxTime, const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *pClientRxTime, int64_t *pClockOffset)</td></tr>
<tr class="memdesc:a2f5c6defb25cc21fdcfee67f48606a03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility to calculate clock offset of system relative to the server using the on-wire protocol specified in the NTPv4 specification. For more information on on-wire protocol, refer to <a href="https://tools.ietf.org/html/rfc5905#section-8">RFC 5905 Section 8</a>.  <a href="core__sntp__serializer_8c.html#a2f5c6defb25cc21fdcfee67f48606a03">More...</a><br /></td></tr>
<tr class="separator:a2f5c6defb25cc21fdcfee67f48606a03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5209122cd78ce9bcad2963851e415ed"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#ad5209122cd78ce9bcad2963851e415ed">parseValidSntpResponse</a> (const <a class="el" href="struct_sntp_packet__t.html">SntpPacket_t</a> *pResponsePacket, const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *pRequestTxTime, const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *pResponseRxTime, <a class="el" href="struct_sntp_response_data__t.html">SntpResponseData_t</a> *pParsedResponse)</td></tr>
<tr class="memdesc:ad5209122cd78ce9bcad2963851e415ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a SNTP response packet by determining whether it is a rejected or accepted response to an SNTP request, and accordingly, populate the <code>pParsedResponse</code> parameter with the parsed data.  <a href="core__sntp__serializer_8c.html#ad5209122cd78ce9bcad2963851e415ed">More...</a><br /></td></tr>
<tr class="separator:ad5209122cd78ce9bcad2963851e415ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3aba893e20b6129984062d1b7bf2fa3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#ae3aba893e20b6129984062d1b7bf2fa3">Sntp_SerializeRequest</a> (<a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *pRequestTime, uint32_t randomNumber, void *pBuffer, size_t bufferSize)</td></tr>
<tr class="memdesc:ae3aba893e20b6129984062d1b7bf2fa3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Serializes an SNTP request packet to use for querying a time server.  <a href="core__sntp__serializer_8c.html#ae3aba893e20b6129984062d1b7bf2fa3">More...</a><br /></td></tr>
<tr class="separator:ae3aba893e20b6129984062d1b7bf2fa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f5dbc349d294809a940ef891cba78fa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#a3f5dbc349d294809a940ef891cba78fa">Sntp_DeserializeResponse</a> (const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *pRequestTime, const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *pResponseRxTime, const void *pResponseBuffer, size_t bufferSize, <a class="el" href="struct_sntp_response_data__t.html">SntpResponseData_t</a> *pParsedResponse)</td></tr>
<tr class="memdesc:a3f5dbc349d294809a940ef891cba78fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">De-serializes an SNTP packet received from a server as a response to a SNTP request.  <a href="core__sntp__serializer_8c.html#a3f5dbc349d294809a940ef891cba78fa">More...</a><br /></td></tr>
<tr class="separator:a3f5dbc349d294809a940ef891cba78fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48dc19a11eb31d6077a2ca8964a1c6a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#a48dc19a11eb31d6077a2ca8964a1c6a9">Sntp_CalculatePollInterval</a> (uint16_t clockFreqTolerance, uint16_t desiredAccuracy, uint32_t *pPollInterval)</td></tr>
<tr class="memdesc:a48dc19a11eb31d6077a2ca8964a1c6a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility to calculate the poll interval of sending periodic time queries to servers to achieve a desired system clock accuracy for a given frequency tolerance of the system clock.  <a href="core__sntp__serializer_8c.html#a48dc19a11eb31d6077a2ca8964a1c6a9">More...</a><br /></td></tr>
<tr class="separator:a48dc19a11eb31d6077a2ca8964a1c6a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2e96d3bc60bb30db3107a2bc1d69121"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="core__sntp__serializer_8c.html#ae2e96d3bc60bb30db3107a2bc1d69121">Sntp_ConvertToUnixTime</a> (const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *pSntpTime, uint32_t *pUnixTimeSecs, uint32_t *pUnixTimeMicrosecs)</td></tr>
<tr class="memdesc:ae2e96d3bc60bb30db3107a2bc1d69121"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility to convert SNTP timestamp (that uses 1st Jan 1900 as the epoch) to UNIX timestamp (that uses 1st Jan 1970 as the epoch).  <a href="core__sntp__serializer_8c.html#ae2e96d3bc60bb30db3107a2bc1d69121">More...</a><br /></td></tr>
<tr class="separator:ae2e96d3bc60bb30db3107a2bc1d69121"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Implementation of the Serializer API of the coreSNTP library. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="af37cd6171731cf259768c8f49df7c07d" name="af37cd6171731cf259768c8f49df7c07d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af37cd6171731cf259768c8f49df7c07d">&#9670;&nbsp;</a></span>SNTP_MODE_BITS_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNTP_MODE_BITS_MASK&#160;&#160;&#160;( 0x07U )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The bit mask for the "Mode" information in the first byte of an SNTP packet. The "Mode" field occupies bits 0-2 of the byte. </p>
<dl class="section note"><dt>Note</dt><dd>Refer to the <a href="https://tools.ietf.org/html/rfc4330#section-4">RFC 4330 Section 4</a> for more information. </dd></dl>

</div>
</div>
<a id="a3a072e2e8031e031c5668b35fa46824b" name="a3a072e2e8031e031c5668b35fa46824b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a072e2e8031e031c5668b35fa46824b">&#9670;&nbsp;</a></span>SNTP_MODE_CLIENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNTP_MODE_CLIENT&#160;&#160;&#160;( 3U )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The value indicating a "client" in the "Mode" field of an SNTP packet. </p>
<dl class="section note"><dt>Note</dt><dd>Refer to the <a href="https://tools.ietf.org/html/rfc4330#section-4">RFC 4330 Section 4</a> for more information. </dd></dl>

</div>
</div>
<a id="a229d48673de40e21a9ec8384f248149c" name="a229d48673de40e21a9ec8384f248149c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a229d48673de40e21a9ec8384f248149c">&#9670;&nbsp;</a></span>SNTP_MODE_SERVER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNTP_MODE_SERVER&#160;&#160;&#160;( 4U )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The value indicating a "server" in the "Mode" field of an SNTP packet. </p>
<dl class="section note"><dt>Note</dt><dd>Refer to the <a href="https://tools.ietf.org/html/rfc4330#section-4">RFC 4330 Section 4</a> for more information. </dd></dl>

</div>
</div>
<a id="ada3c4bedf99dbf21c47a885a3b0ed743" name="ada3c4bedf99dbf21c47a885a3b0ed743"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada3c4bedf99dbf21c47a885a3b0ed743">&#9670;&nbsp;</a></span>SNTP_LEAP_INDICATOR_LSB_POSITION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNTP_LEAP_INDICATOR_LSB_POSITION&#160;&#160;&#160;( 6 )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The position of the least significant bit of the "Leap Indicator" field in first byte of an SNTP packet. The "Leap Indicator" field occupies bits 6-7 of the byte. </p>
<dl class="section note"><dt>Note</dt><dd>Refer to the <a href="https://tools.ietf.org/html/rfc4330#section-4">RFC 4330 Section 4</a> for more information. </dd></dl>

</div>
</div>
<a id="a70e864486560dd0a7728b1fdb66ec20c" name="a70e864486560dd0a7728b1fdb66ec20c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70e864486560dd0a7728b1fdb66ec20c">&#9670;&nbsp;</a></span>SNTP_VERSION_LSB_POSITION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNTP_VERSION_LSB_POSITION&#160;&#160;&#160;( 3 )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The position of least significant bit of the "Version" information in the first byte of an SNTP packet. "Version" field occupies bits 3-5 of the byte. </p>
<dl class="section note"><dt>Note</dt><dd>Refer to the <a href="https://tools.ietf.org/html/rfc4330#section-4">RFC 4330 Section 4</a> for more information. </dd></dl>

</div>
</div>
<a id="a94fde0de05774acb7fe61517ca7e9702" name="a94fde0de05774acb7fe61517ca7e9702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94fde0de05774acb7fe61517ca7e9702">&#9670;&nbsp;</a></span>KOD_CODE_DENY_UINT_VALUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KOD_CODE_DENY_UINT_VALUE&#160;&#160;&#160;( 0x44454e59U )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The integer value of the Kiss-o'-Death ASCII code, "DENY", used for comparison with data in an SNTP response. </p>
<dl class="section note"><dt>Note</dt><dd>Refer to <a href="https://tools.ietf.org/html/rfc4330#section-8">RFC 4330 Section 8</a> for more information. </dd></dl>

</div>
</div>
<a id="a60fc8709a28795ae05af7d140ffb79a4" name="a60fc8709a28795ae05af7d140ffb79a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60fc8709a28795ae05af7d140ffb79a4">&#9670;&nbsp;</a></span>KOD_CODE_RSTR_UINT_VALUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KOD_CODE_RSTR_UINT_VALUE&#160;&#160;&#160;( 0x52535452U )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The integer value of the Kiss-o'-Death ASCII code, "RSTR", used for comparison with data in an SNTP response. </p>
<dl class="section note"><dt>Note</dt><dd>Refer to <a href="https://tools.ietf.org/html/rfc4330#section-8">RFC 4330 Section 8</a> for more information. </dd></dl>

</div>
</div>
<a id="ac8f9569b5f0d4c5dfc0cb0cd0842c895" name="ac8f9569b5f0d4c5dfc0cb0cd0842c895"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8f9569b5f0d4c5dfc0cb0cd0842c895">&#9670;&nbsp;</a></span>KOD_CODE_RATE_UINT_VALUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KOD_CODE_RATE_UINT_VALUE&#160;&#160;&#160;( 0x52415445U )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The integer value of the Kiss-o'-Death ASCII code, "RATE", used for comparison with data in an SNTP response. </p>
<dl class="section note"><dt>Note</dt><dd>Refer to <a href="https://tools.ietf.org/html/rfc4330#section-8">RFC 4330 Section 8</a> for more information. </dd></dl>

</div>
</div>
<a id="aaacfadcc9b6655aa09392826d867d0fd" name="aaacfadcc9b6655aa09392826d867d0fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaacfadcc9b6655aa09392826d867d0fd">&#9670;&nbsp;</a></span>CLOCK_OFFSET_MAX_TIME_DIFFERENCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CLOCK_OFFSET_MAX_TIME_DIFFERENCE&#160;&#160;&#160;( ( ( ( int64_t ) INT32_MAX + 1 ) * 1000 ) )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Macro to represent exactly half of the total number of seconds in an NTP era. As 32 bits are used to represent the "seconds" part of an SNTP timestamp, the half of the total range of seconds in an NTP era is 2^31 seconds, which represents ~68 years. </p>
<dl class="section note"><dt>Note</dt><dd>This macro represents the edge case of calculating the client system clock-offset relative to server time as the library ASSUMES that the client and server times are within 2^31 seconds apart in duration. This is done to support calculating clock-offset for the cases when server and client systems are in adjacent NTP eras, which can occur when NTP time wraps around in 2036, and the relative NTP era presence of client and server times is determined based on comparing first order difference values between all possible NTP era configurations of the systems. </dd></dl>

</div>
</div>
<a id="aad423a3e191fa073a8a8cb101a2f4474" name="aad423a3e191fa073a8a8cb101a2f4474"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad423a3e191fa073a8a8cb101a2f4474">&#9670;&nbsp;</a></span>TOTAL_MILLISECONDS_IN_NTP_ERA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TOTAL_MILLISECONDS_IN_NTP_ERA&#160;&#160;&#160;( ( ( int64_t ) UINT32_MAX + 1 ) * 1000 )</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Macro to represent the total number of milliseconds that are represented in an NTP era period. This macro represents a duration of ~136 years. </p>
<dl class="section note"><dt>Note</dt><dd>Rationale for calculation: The "seconds" part of an NTP timestamp is represented in unsigned 32 bit width, thus, the total range of seconds it represents is 2^32, i.e. (UINT32_MAX + 1). </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a4d0924478bfb3aa69745bd8974e25b8a" name="a4d0924478bfb3aa69745bd8974e25b8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d0924478bfb3aa69745bd8974e25b8a">&#9670;&nbsp;</a></span>fillWordMemoryInNetworkOrder()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void fillWordMemoryInNetworkOrder </td>
          <td>(</td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>pWordMemory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility macro to fill 32-bit integer in word-sized memory in network byte (or Big Endian) order. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pWordMemory</td><td>Pointer to the word-sized memory in which the 32-bit integer will be filled. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>The 32-bit integer to fill in the <code>wordMemory</code> in network byte order.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This utility ensures that data is filled in memory in expected network byte order, as an assignment operation (like *pWordMemory = word) can cause undesired side-effect of network-byte ordering getting reversed on Little Endian platforms. </dd></dl>

</div>
</div>
<a id="a69acf27cf58eff4f2f9a6057e9992781" name="a69acf27cf58eff4f2f9a6057e9992781"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69acf27cf58eff4f2f9a6057e9992781">&#9670;&nbsp;</a></span>readWordFromNetworkByteOrderMemory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint32_t readWordFromNetworkByteOrderMemory </td>
          <td>(</td>
          <td class="paramtype">const uint32_t *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility macro to generate a 32-bit integer from memory containing integer in network (or Big Endian) byte order. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ptr</td><td>Pointer to the memory containing 32-bit integer in network byte order.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The host representation of the 32-bit integer in the passed word memory. </dd></dl>

</div>
</div>
<a id="a53e589c52b81e5852c6b56a9b66d5eb2" name="a53e589c52b81e5852c6b56a9b66d5eb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53e589c52b81e5852c6b56a9b66d5eb2">&#9670;&nbsp;</a></span>absoluteOf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int64_t absoluteOf </td>
          <td>(</td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility to return absolute (or positively signed) value of an signed 64 bit integer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">value</td><td>The integer to return the absolute value of.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The absolute value of <code>value</code>. </dd></dl>

</div>
</div>
<a id="a04c87586b09d72d7dff92797673eed75" name="a04c87586b09d72d7dff92797673eed75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04c87586b09d72d7dff92797673eed75">&#9670;&nbsp;</a></span>isZeroTimestamp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool isZeroTimestamp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *&#160;</td>
          <td class="paramname"><em>pTime</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility to determine whether a timestamp represents a zero timestamp value. </p>
<dl class="section note"><dt>Note</dt><dd>This utility is used to determine whether a timestamp value is invalid. According to the SNTPv4 specification, a zero timestamp value is considered invalid.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pTime</td><td>The timestamp whose value is to be inspected for zero value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the timestamp is zero; otherwise <code>false</code>. </dd></dl>

</div>
</div>
<a id="afec85474dae06b84849cd72605c70ca8" name="afec85474dae06b84849cd72605c70ca8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afec85474dae06b84849cd72605c70ca8">&#9670;&nbsp;</a></span>fractionsToMs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint32_t fractionsToMs </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>fractions</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility to convert the "fractions" part of an SNTP timestamp to milliseconds duration of time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fractions</td><td>The fractions value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The milliseconds equivalent of the <code>fractions</code> value. </dd></dl>

</div>
</div>
<a id="ae8e1e3b85a690e31996bdd2129dd5898" name="ae8e1e3b85a690e31996bdd2129dd5898"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8e1e3b85a690e31996bdd2129dd5898">&#9670;&nbsp;</a></span>safeTimeDifference()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int64_t safeTimeDifference </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *&#160;</td>
          <td class="paramname"><em>pServerTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *&#160;</td>
          <td class="paramname"><em>pClientTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility to safely calculate difference between server and client timestamps and return the difference in the resolution of milliseconds as a signed 64 bit integer. The calculated value represents the effective subtraction as ( <code>serverTimeSec</code> - <code>clientTimeSec</code> ). </p>
<dl class="section note"><dt>Note</dt><dd>This utility SUPPORTS the cases of server and client timestamps being in different NTP eras, and ASSUMES that the server and client systems are within 68 years of each other. To handle the case of different NTP eras, this function calculates difference values for all possible combinations of NTP eras of server and client times (i.e. 1. both timestamps in same era,<ol type="1">
<li>server timestamp one era ahead, and 3. client timestamp being one era ahead), and determines the NTP era configuration by choosing the difference value of the smallest absolute value.</li>
</ol>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pServerTime</td><td>The server timestamp. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pClientTime</td><td>The client timestamp.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The calculated difference between server and client times as a signed 64 bit integer. </dd></dl>

</div>
</div>
<a id="a2f5c6defb25cc21fdcfee67f48606a03" name="a2f5c6defb25cc21fdcfee67f48606a03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f5c6defb25cc21fdcfee67f48606a03">&#9670;&nbsp;</a></span>calculateClockOffset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void calculateClockOffset </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *&#160;</td>
          <td class="paramname"><em>pClientTxTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *&#160;</td>
          <td class="paramname"><em>pServerRxTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *&#160;</td>
          <td class="paramname"><em>pServerTxTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *&#160;</td>
          <td class="paramname"><em>pClientRxTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t *&#160;</td>
          <td class="paramname"><em>pClockOffset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Utility to calculate clock offset of system relative to the server using the on-wire protocol specified in the NTPv4 specification. For more information on on-wire protocol, refer to <a href="https://tools.ietf.org/html/rfc5905#section-8">RFC 5905 Section 8</a>. </p>
<dl class="section note"><dt>Note</dt><dd>The following diagram explains the calculation of the clock offset: <pre class="fragment">            T2      T3
 ---------------------------------   &lt;-----   *SNTP/NTP server*
          /\         \
          /           \
Request* /             \ *Response*
        /              \/
 ---------------------------------   &lt;-----   *SNTP client*
      T1                T4
</pre> The four most recent timestamps, T1 through T4, are used to compute the clock offset of SNTP client relative to the server where:</dd></dl>
<p>T1 = Client Request Transmit Time T2 = Server Receive Time (of client request) T3 = Server Response Transmit Time T4 = Client Receive Time (of server response)</p>
<p >Clock Offset = T(NTP/SNTP server) - T(SNTP client) </p>
<h2><a class="anchor" id="autotoc_md0"></a>
= [( T2 - T1 ) + ( T3 - T4 )]</h2>
<p >2</p>
<dl class="section note"><dt>Note</dt><dd>Both NTPv4 and SNTPv4 specifications suggest calculating the clock offset value, if possible. As the timestamp format uses 64 bit integer and there exist 2 orders of arithmetic calculations on the timestamp values (subtraction followed by addition as shown in the diagram above), the clock offset for the system can be calculated ONLY if the value can be represented in 62 significant bits and 2 sign bits i.e. if the system clock is within 34 years (in the future or past) of the server time.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pClientTxTime</td><td>The system time of sending the SNTP request. This is the same as "T1" in the above diagram. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pServerRxTime</td><td>The server time of receiving the SNTP request packet from the client. This is the same as "T2" in the above diagram. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pServerTxTime</td><td>The server time of sending the SNTP response packet. This is the same as "T3" in the above diagram. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pClientRxTime</td><td>The system time of receiving the SNTP response from the server. This is the same as "T4" in the above diagram. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pClockOffset</td><td>This will be filled with the calculated offset value of the system clock relative to the server time with the assumption that the system clock is within 68 years of server time. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad5209122cd78ce9bcad2963851e415ed" name="ad5209122cd78ce9bcad2963851e415ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5209122cd78ce9bcad2963851e415ed">&#9670;&nbsp;</a></span>parseValidSntpResponse()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a> parseValidSntpResponse </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_sntp_packet__t.html">SntpPacket_t</a> *&#160;</td>
          <td class="paramname"><em>pResponsePacket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *&#160;</td>
          <td class="paramname"><em>pRequestTxTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *&#160;</td>
          <td class="paramname"><em>pResponseRxTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_sntp_response_data__t.html">SntpResponseData_t</a> *&#160;</td>
          <td class="paramname"><em>pParsedResponse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parse a SNTP response packet by determining whether it is a rejected or accepted response to an SNTP request, and accordingly, populate the <code>pParsedResponse</code> parameter with the parsed data. </p>
<dl class="section note"><dt>Note</dt><dd>If the server has rejected the request with the a Kiss-o'-Death message, then this function will set the associated rejection code in the output parameter while setting the remaining members to zero. If the server has accepted the time request, then the function will set the rejectedResponseCode member of the output parameter to <a class="el" href="group__sntp__constants.html#ga2f15147fd62ad044b87f8da1cd3f9f7a" title="The value for the SntpResponseData_t.rejectedResponseCode member when that the server response packet...">SNTP_KISS_OF_DEATH_CODE_NONE</a>, and set the other the members with appropriate data extracted from the response packet.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pResponsePacket</td><td>The SNTP response packet from server to parse. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pRequestTxTime</td><td>The system time (in SNTP timestamp format) of sending the SNTP request to server. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pResponseRxTime</td><td>The system time (in SNTP timestamp format) of receiving the SNTP response from server. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pParsedResponse</td><td>The parameter that will be populated with data parsed from the response packet, <code>pResponsePacket</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function returns one of the following:<ul>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a8486f9ee1815b43418a9c0478bd8f016" title="Successful operation of an SNTP API.">SntpSuccess</a> if the server response does not represent a Kiss-o'-Death message.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a771181dbb6df4fb8c21fcb5a160f5ba4" title="Server sent a Kiss-o&#39;-Death message with non-retryable code (i.e. DENY or RSTR).">SntpRejectedResponseChangeServer</a> if the server rejected with a code indicating that client cannot be retry requests to it.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a7c75142ae7cd69ed56d05212ec59a267" title="Server sent a Kiss-o&#39;-Death message with a RATE code, which means that client should back-off before ...">SntpRejectedResponseRetryWithBackoff</a> if the server rejected with a code indicating that client should back-off before retrying request.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798adcd6c832a7a1c2d4e656538b5e6fefe9" title="Server sent a Kiss-o&#39;-Death message with a code, specific to the server. Application can inspect the ...">SntpRejectedResponseOtherCode</a> if the server rejected with a code other than "DENY", "RSTR" and "RATE". </li>
</ul>
</dd></dl>

</div>
</div>
<a id="ae3aba893e20b6129984062d1b7bf2fa3" name="ae3aba893e20b6129984062d1b7bf2fa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3aba893e20b6129984062d1b7bf2fa3">&#9670;&nbsp;</a></span>Sntp_SerializeRequest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a> Sntp_SerializeRequest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *&#160;</td>
          <td class="paramname"><em>pRequestTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>randomNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>bufferSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Serializes an SNTP request packet to use for querying a time server. </p>
<p >This function will fill only <a class="el" href="group__sntp__constants.html#ga9fb0febdb6e2f2dff2e133ef49ce205b" title="The base packet size of request and response of the (S)NTP protocol.">SNTP_PACKET_BASE_SIZE</a> bytes of data in the passed buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pRequestTime</td><td>The current time of the system, expressed as time since the SNTP epoch (i.e. 0h of 1st Jan 1900 ). This time will be serialized in the SNTP request packet. The function will use this parameter to return the timestamp serialized in the SNTP request. To protect against attacks spoofing server responses, the timestamp MUST NOT be zero in value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">randomNumber</td><td>A random number (generated by a True Random Generator) for use in the SNTP request packet to protect against replay attacks as suggested by SNTPv4 specification. For more information, refer to <a href="https://tools.ietf.org/html/rfc4330#section-3">RFC 4330 Section 3</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pBuffer</td><td>The buffer that will be populated with the serialized SNTP request packet. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bufferSize</td><td>The size of the <code>pBuffer</code> buffer. It should be at least <a class="el" href="group__sntp__constants.html#ga9fb0febdb6e2f2dff2e133ef49ce205b" title="The base packet size of request and response of the (S)NTP protocol.">SNTP_PACKET_BASE_SIZE</a> bytes in size.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>It is recommended to use a True Random Generator (TRNG) to generate the random number. </dd>
<dd>
The application MUST save the <code>pRequestTime</code> value for de-serializing the server response with <a class="el" href="core__sntp__serializer_8h.html#a3f5dbc349d294809a940ef891cba78fa">Sntp_DeserializeResponse</a> API.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>This function returns one of the following:<ul>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a8486f9ee1815b43418a9c0478bd8f016" title="Successful operation of an SNTP API.">SntpSuccess</a> when serialization operation is successful.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a1829c0158e4f2630b6806afa4511dfd7" title="Invalid parameter passed to an API function.">SntpErrorBadParameter</a> if an invalid parameter is passed.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a23891833ba2ad8634832cbbb9d47bd9c" title="Application provided insufficient buffer space for serializing or de-serializing an SNTP packet....">SntpErrorBufferTooSmall</a> if the buffer does not have the minimum size for serializing an SNTP request packet. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="a3f5dbc349d294809a940ef891cba78fa" name="a3f5dbc349d294809a940ef891cba78fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f5dbc349d294809a940ef891cba78fa">&#9670;&nbsp;</a></span>Sntp_DeserializeResponse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a> Sntp_DeserializeResponse </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *&#160;</td>
          <td class="paramname"><em>pRequestTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *&#160;</td>
          <td class="paramname"><em>pResponseRxTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>pResponseBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>bufferSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_sntp_response_data__t.html">SntpResponseData_t</a> *&#160;</td>
          <td class="paramname"><em>pParsedResponse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>De-serializes an SNTP packet received from a server as a response to a SNTP request. </p>
<p >This function will parse only the <a class="el" href="group__sntp__constants.html#ga9fb0febdb6e2f2dff2e133ef49ce205b" title="The base packet size of request and response of the (S)NTP protocol.">SNTP_PACKET_BASE_SIZE</a> bytes of data in the passed buffer.</p>
<dl class="section note"><dt>Note</dt><dd>If the server has sent a Kiss-o'-Death message to reject the associated time request, the API function will return the appropriate return code and, also, provide the ASCII code (of fixed length, <a class="el" href="group__sntp__constants.html#ga4aa0a62f06b36e48b47e609a6cd0f3ca" title="The fixed-length of any Kiss-o&#39;-Death message ASCII code sent in an SNTP server response.">SNTP_KISS_OF_DEATH_CODE_LENGTH</a> bytes) in the <a class="el" href="struct_sntp_response_data__t.html#a6ce5c37cac67aea775f9578fa4d95e1a" title="If a server responded with Kiss-o&#39;-Death message to reject time request, this is the fixed length ASC...">SntpResponseData_t.rejectedResponseCode</a> member of <code>pParsedResponse</code> parameter, parsed from the response packet. The application SHOULD respect the server rejection and take appropriate action based on the rejection code. If the server response represents an accepted SNTP client request, then the API function will set the <a class="el" href="struct_sntp_response_data__t.html#a6ce5c37cac67aea775f9578fa4d95e1a" title="If a server responded with Kiss-o&#39;-Death message to reject time request, this is the fixed length ASC...">SntpResponseData_t.rejectedResponseCode</a> member of <code>pParsedResponse</code> parameter to <a class="el" href="group__sntp__constants.html#ga2f15147fd62ad044b87f8da1cd3f9f7a" title="The value for the SntpResponseData_t.rejectedResponseCode member when that the server response packet...">SNTP_KISS_OF_DEATH_CODE_NONE</a>.</dd>
<dd>
If the server has positively responded with its clock time, then this API function will calculate the clock-offset. For the clock-offset to be correctly calculated, the system clock MUST be within ~68 years (or 2^31 seconds) of the server time mentioned. This function supports clock-offset calculation when server and client timestamps are in adjacent NTP eras, with one system is in NTP era 0 (i.e. before 7 Feb 2036 6h:28m:14s UTC) and another system in NTP era 1 (on or after 7 Feb 2036 6h:28m:14s UTC).</dd>
<dd>
In the special case when the server and client times are exactly 2^31 seconds apart, the library ASSUMES that the server time is ahead of the client time, and returns the positive clock-offset value of INT32_MAX seconds.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pRequestTime</td><td>The system time used in the SNTP request packet that is associated with the server response. This MUST be the same as the time returned by the <a class="el" href="core__sntp__serializer_8h.html#ae3aba893e20b6129984062d1b7bf2fa3">Sntp_SerializeRequest</a> API. To protect against attacks spoofing server responses, this timestamp MUST NOT be zero in value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pResponseRxTime</td><td>The time of the system, expressed as time since the SNTP epoch (i.e. 0h of 1st Jan 1900 ), at receiving SNTP response from server. This time will be used to calculate system clock offset relative to server. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pResponseBuffer</td><td>The buffer containing the SNTP response from the server. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bufferSize</td><td>The size of the <code>pResponseBuffer</code> containing the SNTP response. It MUST be at least <a class="el" href="group__sntp__constants.html#ga9fb0febdb6e2f2dff2e133ef49ce205b" title="The base packet size of request and response of the (S)NTP protocol.">SNTP_PACKET_BASE_SIZE</a> bytes long for a valid SNTP response. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pParsedResponse</td><td>The information parsed from the SNTP response packet. If possible to calculate without overflow, it also contains the system clock offset relative to the server time.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>This function returns one of the following:<ul>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a8486f9ee1815b43418a9c0478bd8f016" title="Successful operation of an SNTP API.">SntpSuccess</a> if the de-serialization operation is successful.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a1829c0158e4f2630b6806afa4511dfd7" title="Invalid parameter passed to an API function.">SntpErrorBadParameter</a> if an invalid parameter is passed.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a23891833ba2ad8634832cbbb9d47bd9c" title="Application provided insufficient buffer space for serializing or de-serializing an SNTP packet....">SntpErrorBufferTooSmall</a> if the buffer does not have the minimum size required for a valid SNTP response packet.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a4a4f61809052a98c2877cf5035ccc62c" title="Server response failed validation checks for expected data in SNTP packet.">SntpInvalidResponse</a> if the response fails sanity checks expected in an SNTP response.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a771181dbb6df4fb8c21fcb5a160f5ba4" title="Server sent a Kiss-o&#39;-Death message with non-retryable code (i.e. DENY or RSTR).">SntpRejectedResponseChangeServer</a> if the server rejected with a code indicating that client cannot be retry requests to it.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a7c75142ae7cd69ed56d05212ec59a267" title="Server sent a Kiss-o&#39;-Death message with a RATE code, which means that client should back-off before ...">SntpRejectedResponseRetryWithBackoff</a> if the server rejected with a code indicating that client should back-off before retrying request.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798adcd6c832a7a1c2d4e656538b5e6fefe9" title="Server sent a Kiss-o&#39;-Death message with a code, specific to the server. Application can inspect the ...">SntpRejectedResponseOtherCode</a> if the server rejected with a code that application can inspect in the <code>pParsedResponse</code> parameter. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="a48dc19a11eb31d6077a2ca8964a1c6a9" name="a48dc19a11eb31d6077a2ca8964a1c6a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48dc19a11eb31d6077a2ca8964a1c6a9">&#9670;&nbsp;</a></span>Sntp_CalculatePollInterval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a> Sntp_CalculatePollInterval </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>clockFreqTolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>desiredAccuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>pPollInterval</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Utility to calculate the poll interval of sending periodic time queries to servers to achieve a desired system clock accuracy for a given frequency tolerance of the system clock. </p>
<p >For example, from the SNTPv4 specification, "if the frequency tolerance
is 200 parts per million (PPM) and the required accuracy is one minute,
the maximum timeout is about 3.5 days". In this example, the system clock frequency tolerance is 200 PPM and the desired accuracy is 60000 milliseconds (or 1 minute) for which this API function will return the maximum poll interval value as 2^18 seconds (or ~3 days).</p>
<dl class="section note"><dt>Note</dt><dd>The poll interval returned is a power of 2, which is the standard way to represent the value. According to the SNTPv4 specification Best Practices, an SNTP client SHOULD NOT have a poll interval less than 15 seconds. <a href="https://tools.ietf.org/html/rfc4330#section-10">https://tools.ietf.org/html/rfc4330#section-10</a>. This API function DOES NOT support poll interval calculation less than 1 second.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">clockFreqTolerance</td><td>The frequency tolerance of system clock in parts per million (PPM) units. This parameter MUST be non-zero. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">desiredAccuracy</td><td>The acceptable maximum drift, in milliseconds, for the system clock. The maximum value (0xFFFF) represents ~1 minute of desired clock accuracy. This parameter MUST be non-zero. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pPollInterval</td><td>This is filled with the poll interval, in seconds calculated as the closest power of 2 value that will achieve either the exact desired or higher clock accuracy <code>desiredAccuracy</code>, for the given clock frequency tolerance, <code>clockFreqTolerance</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns one of the following:<ul>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a8486f9ee1815b43418a9c0478bd8f016" title="Successful operation of an SNTP API.">SntpSuccess</a> if calculation is successful.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a1829c0158e4f2630b6806afa4511dfd7" title="Invalid parameter passed to an API function.">SntpErrorBadParameter</a> for an invalid parameter passed to the function.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a2b694f63eaa4d94d08e1bbc80f6fd992" title="Poll interval value is under 1 second which cannot be calculated by Sntp_CalculatePollInterval.">SntpZeroPollInterval</a> if calculated poll interval is less than 1 second. </li>
</ul>
</dd></dl>

</div>
</div>
<a id="ae2e96d3bc60bb30db3107a2bc1d69121" name="ae2e96d3bc60bb30db3107a2bc1d69121"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2e96d3bc60bb30db3107a2bc1d69121">&#9670;&nbsp;</a></span>Sntp_ConvertToUnixTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__sntp__enum__types.html#gaef7b22d8008bbfbbc7bbea5a7a30e798">SntpStatus_t</a> Sntp_ConvertToUnixTime </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_sntp_timestamp__t.html">SntpTimestamp_t</a> *&#160;</td>
          <td class="paramname"><em>pSntpTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>pUnixTimeSecs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>pUnixTimeMicrosecs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Utility to convert SNTP timestamp (that uses 1st Jan 1900 as the epoch) to UNIX timestamp (that uses 1st Jan 1970 as the epoch). </p>
<dl class="section note"><dt>Note</dt><dd>This function can ONLY handle conversions of SNTP timestamps that lie in the range from 1st Jan 1970 0h 0m 0s, the UNIX epoch time, to 19th Jan 2038 3h 14m 7s, the maximum UNIX time that can be represented in a signed 32 bit integer. (The limitation is to support systems that use signed 32-bit integer to represent the seconds part of the UNIX time.)</dd>
<dd>
This function supports overflow of the SNTP timestamp (from the 7 Feb 2036 6h 28m 16s time, i.e. SNTP era 1) by treating the timestamps with seconds part in the range [0, 61,505,152] seconds where the upper limit represents the UNIX overflow time (i.e. 19 Jan 2038 3h 14m 7s) for systems that use signed 32-bit integer to represent time.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pSntpTime</td><td>The SNTP timestamp to convert to UNIX time. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pUnixTimeSecs</td><td>This will be filled with the seconds part of the UNIX time equivalent of the SNTP time, <code>pSntpTime</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pUnixTimeMicrosecs</td><td>This will be filled with the microseconds part of the UNIX time equivalent of the SNTP time, <code>pSntpTime</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns one of the following:<ul>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a8486f9ee1815b43418a9c0478bd8f016" title="Successful operation of an SNTP API.">SntpSuccess</a> if conversion to UNIX time is successful</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798a1829c0158e4f2630b6806afa4511dfd7" title="Invalid parameter passed to an API function.">SntpErrorBadParameter</a> if any of the passed parameters are NULL.</li>
<li><a class="el" href="group__sntp__enum__types.html#ggaef7b22d8008bbfbbc7bbea5a7a30e798afba7203b8ee0322999adf1edcca6e0cf" title="SNTP timestamp cannot be converted to UNIX time as time does not lie in time range supported by Sntp_...">SntpErrorTimeNotSupported</a> if the passed SNTP time does not lie in the supported time range. </li>
</ul>
</dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="core__sntp__serializer_8c.html">core_sntp_serializer.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
